<!DOCTYPE html>
<html>
<head>
  <title>STARLAB Homepage</title>
  <link rel="shortcut icon" href="data:image/x-icon," type="image/x-icon">
  <link rel="stylesheet" href="./css/style.css">
  <script src="https://code.jquery.com/jquery-latest.min.js"></script>
  <script type="text/javascript" src=" http://maps.google.com/maps/api/js?v=3.3&sensor=true"></script>
  <meta charset="utf-8">
</head>
<body>
    <div class="frame">
        <div class="header">
          <div class="logo">STAR LAB - Software Analysis Laboratory</div>
        </div>
        <!-- //header -->
        <div class="container">
          <div class="nav">
            <div class="nav-contents">
              <div class="nav-header">
                Categories
              </div>
              <ul class="nav-list">
                <li class="nav-item"><a href="" class="nav-link home">Home</a></li>
                <li class="nav-item"><a href="" class="nav-link contact">Contact</a></li>
                <li class="nav-item"><a href="" class="nav-link">Project</a></li>
                <li class="nav-item"><a href="" class="nav-link documents">Documents</a></li>
                <li class="nav-item"><a href="" class="nav-link people">People</a></li>
              </ul>
            </div>
          </div>
          <!-- //nav -->
          <div class="content">
          </div>
        </div>
        <!-- //container -->
        <div class="footer">
          <p class="copyright">Copy right &copy | <a href="http://prl.korea.ac.kr/~pronto/home/">Software Analysis Laboratory.</a> @ Korea University</p>
        </div>
        <!-- //footer -->
      </div>
      <!-- //frame -->
</html>
<script>
  /* Replace contents element by parsing data */
  function make_new_wrapper() {
    return $("<div>").addClass("content-wrapper")
  }
  
  function replace_content(title, data) {
    var content = $(".content")
    var title = $("<h1>").html(title)
    content.empty().append(title).append(data)
  }

  /* Return one person info card */
  function make_person_block(data) {
    var card = $("<div>").addClass("people-card")
    var name = $("<div>").addClass("people-name").html(data["Name"])
    var position = $("<div>").addClass("people-position").html(data["Position"])
    var email = $("<div>").addClass("people-email").append($("<a>").addClass("e-mail").html(data["E-mail"]))
    
    card = card.append(name).append(position).append(email)
    return card
  }

  function make_people_group(header, data_list) {
    var block = $("<div>").add("card-group")
    var title = $("<h2>").html(header)
    
    block = block.append(title)
    for(var i=0; i<data_list.length; i++){
      block = block.append(make_person_block(data_list[i]))
    }

    return block
  }

  /* Render index page */
  function render_index(data) {
    var sections = data["sections"]
    var content = make_new_wrapper();

    for (var i=0;i<sections.length; i++){
      var section = $("<div>").addClass("section-card")
      var title = $("<h2>").html(sections[i]["title"])
      var text = $("<p>").addClass("section-content").html(sections[i]["text"])
      
      section = section.append(title).append(text)
      content = content.append(section)
    }

    replace_content("Home", content)
  }

  /* Render contact page */
  function render_contact(data) {
    var map_src = "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d36576.18884349086!2d126.97423858472392!3d37.56088956204506!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x357cbcb08a5790df%3A0x21f0604c311dc40d!2z6rOg66Ck64yA7ZWZ6rWQIOqzvO2VmeuPhOyEnOq0gA!5e0!3m2!1sko!2skr!4v1606305690284!5m2!1sko!2skr"
    //width="400" height="300" frameborder="0" style="border:0;" allowfullscreen="" aria-hidden="false" tabindex="0"
    var map = $("<iframe>").attr("src", map_src).attr("frameborder", "0").attr("allowfullscreen", "false").addClass("map-frame")

    replace_content("Contact", map)
    init_location()
  }

  /* Render document page */
  function render_documents(data) {
    var documents = data["reports"];
    var publications = data["publications"];

    var content = make_new_wrapper();

    /* Render all documents */
    var document_block = $("<div>").addClass("document-block").html("<h2>Documentations</h2>")
    for (var i=0; i<documents.length; i++){
      var document = $("<div>").addClass("document-card")
      var title = $("<h3>").html(documents[i]["title"])
      var desc = $("<div>").addClass("document-desc").html(documents[i]["description"])
      var link = $("<div>").addClass("document-link").append(
        $("<a>").attr("target","_blank").attr("href",documents[i]["url"]).html("pdf")
      ).prepend("[").append("]")

      document = document.append(title).append(desc).append(link)
      document_block = document_block.append(document)
    } 

    /* Render all publications */
    var publication_block = $("<div>").addClass("document-block").html("<h2>Publications</h2>")
    for (var i=0; i<publications.length; i++){
      var publication = $("<div>").addClass("document-card")
      var title = $("<h3>").html(publications[i]["title"])
      var authors = $("<div>").addClass("document-authors").html(publications[i]["authors"])
      var conference = $("<div>").addClass("document-conference").append(
        $("<a>").attr("target","_blank").attr("href",publications[i]["conference_url"]).html(publications[i]["conference"])
      )
      var paper_link = $("<div>").addClass("document-link").append(
        $("<a>").attr("target","_blank").attr("href",publications[i]["paper_url"]).html("pdf")
      ).prepend("[").append("]")

      publication = publication.append(title).append(authors).append(conference).append(paper_link)
      publication_block = publication_block.append(publication)
    } 

    content = content.append(document_block).append(publication_block)
    replace_content("Documents", content)
  }

  /* Render people page */
  function render_people(data) {
    var content = make_new_wrapper();
    var leaders = data["Project Leader"]
    var members = data["Members"]

    var lblock = $("<div>").addClass("left-block")
    var rblock = $("<div>").addClass("right-block")

    /* Render left block (project leaders) */
    var leader_group = make_people_group ("Project Leader", leaders)
    lblock = lblock.append(leader_group)

    /* Render right block (project members) */
    var member_group = make_people_group ("Members", members)
    rblock = rblock.append(member_group)

    replace_content("People", content.append(lblock).append(rblock))
  }
  
  /* On-click renders */
  $(".home").on("click", function(e) {
    e.preventDefault()
    $.ajax({
      type: "GET",
      url: "./contents/home.json",
      dataType: "JSON",
      success: function(data){
        $(".selected").removeClass("selected")
        $(e.target).addClass("selected")
        render_index(data)
      }
    })
  })

  $(".contact").on("click", function(e) {
    e.preventDefault()
    $.ajax({
      type: "GET",
      url: "./contents/contact.json",
      dataType: "JSON",
      success: function(data){
        $(".selected").removeClass("selected")
        $(e.target).addClass("selected")
        render_contact(data)
      }
    })
  })

  $(".documents").on("click", function(e) {
    e.preventDefault()
    $.ajax({
      type: "GET",
      url: "./contents/documents.json",
      dataType: "JSON",
      success: function(data){
        $(".selected").removeClass("selected")
        $(e.target).addClass("selected")
        render_documents(data)
      }
    })
  })

  $(".people").on("click", function(e) {
    e.preventDefault()
    $.ajax({
      type: "GET",
      url: "./contents/people.json",
      dataType: "JSON",
      success: function(data){
        $(".selected").removeClass("selected")
        $(e.target).addClass("selected")
        render_people(data)
      }
    })
  })

  /* Document load */
  $(document).ready(function() {
    $.ajax({
      type: "GET",
      url: "./contents/home.json",
      dataType: "JSON",
      success: function(data){
        render_index(data)
      }
    })
  })
</script>